import{FaceTracker as C,PoseTracker as X}from'@geenee/bodytracking';import{Processor as O,Engine as m,VideoCapture as q}from'@geenee/armature';var M=function(z,K){return M=Object['setPrototypeOf']||{'__proto__':[]}instanceof Array&&function(Z,y){Z['__proto__']=y;}||function(Z,y){for(var P in y)Object['prototype']['hasOwnProperty']['call'](y,P)&&(Z[P]=y[P]);},M(z,K);};function j(z,K){if('function'!=typeof K&&null!==K)throw new TypeError('Class\x20extends\x20value\x20'+String(K)+'\x20is\x20not\x20a\x20constructor\x20or\x20null');function Z(){this['constructor']=z;}M(z,K),z['prototype']=null===K?Object['create'](K):(Z['prototype']=K['prototype'],new Z());}function E(z,K,Z,y){return new(Z||(Z=Promise))(function(P,B){function w(T){try{U(y['next'](T));}catch(g){B(g);}}function S(T){try{U(y['throw'](T));}catch(g){B(g);}}function U(T){var g;T['done']?P(T['value']):(g=T['value'],g instanceof Z?g:new Z(function(L){L(g);}))['then'](w,S);}U((y=y['apply'](z,K||[]))['next']());});}function b(z,K){var Z,y,P,B,w={'label':0x0,'sent':function(){if(0x1&P[0x0])throw P[0x1];return P[0x1];},'trys':[],'ops':[]};return B={'next':S(0x0),'throw':S(0x1),'return':S(0x2)},'function'==typeof Symbol&&(B[Symbol['iterator']]=function(){return this;}),B;function S(U){return function(T){return function(g){if(Z)throw new TypeError('Generator\x20is\x20already\x20executing.');for(;w;)try{if(Z=0x1,y&&(P=0x2&g[0x0]?y['return']:g[0x0]?y['throw']||((P=y['return'])&&P['call'](y),0x0):y['next'])&&!(P=P['call'](y,g[0x1]))['done'])return P;switch(y=0x0,P&&(g=[0x2&g[0x0],P['value']]),g[0x0]){case 0x0:case 0x1:P=g;break;case 0x4:return w['label']++,{'value':g[0x1],'done':!0x1};case 0x5:w['label']++,y=g[0x1],g=[0x0];continue;case 0x7:g=w['ops']['pop'](),w['trys']['pop']();continue;default:if(!(P=w['trys'],(P=P['length']>0x0&&P[P['length']-0x1])||0x6!==g[0x0]&&0x2!==g[0x0])){w=0x0;continue;}if(0x3===g[0x0]&&(!P||g[0x1]>P[0x0]&&g[0x1]<P[0x3])){w['label']=g[0x1];break;}if(0x6===g[0x0]&&w['label']<P[0x1]){w['label']=P[0x1],P=g;break;}if(P&&w['label']<P[0x2]){w['label']=P[0x2],w['ops']['push'](g);break;}P[0x2]&&w['ops']['pop'](),w['trys']['pop']();continue;}g=K['call'](z,w);}catch(L){g=[0x6,L],y=0x0;}finally{Z=P=0x0;}if(0x5&g[0x0])throw g[0x1];return{'value':g[0x0]?g[0x1]:void 0x0,'done':!0x0};}([U,T]);};}}var A=function(z){function K(){var Z=null!==z&&z['apply'](this,arguments)||this;return Z['faceTracker']=new C(),Z['cameraAngleBase']=0xa/0xb4*Math['PI'],Z;}return j(K,z),K['prototype']['init']=function(Z,y,P){return E(this,void 0x0,void 0x0,function(){return b(this,function(B){switch(B['label']){case 0x0:return[0x4,this['faceTracker']['init'](Z['token'],Z['root'],Z['cache'],Z['highp'])];case 0x1:return B['sent'](),[0x4,this['faceTracker']['prepare']()];case 0x2:return B['sent'](),[0x2,z['prototype']['init']['call'](this,Z,y,P)];}});});},K['prototype']['reset']=function(){this['faceTracker']['reset'](),z['prototype']['reset']['call'](this);},K['prototype']['dispose']=function(){this['faceTracker']['dispose']();},K['prototype']['process']=function(Z,y){return E(this,void 0x0,void 0x0,function(){var P,B,w,S,U;return b(this,function(T){switch(T['label']){case 0x0:return[0x4,this['faceTracker']['process'](Z,y)];case 0x1:return P=T['sent'](),B=P['length']>0x0?P[0x0]:void 0x0,w=B&&this['params']['transform']?this['faceTracker']['align'](B['keypoints']):void 0x0,S=w&&this['params']['metric']?this['faceTracker']['metricPoints']():void 0x0,U=w&&this['params']['backproj']?this['faceTracker']['backprojPoints']():void 0x0,[0x2,{'mesh':B,'transform':w,'metric':S,'backproj':U}];}});});},K['prototype']['setupVideo']=function(Z,y){z['prototype']['setupVideo']['call'](this,Z,y),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['faceTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['faceTracker']['reset']();},K;}(O),R=function(z){function K(Z,y){return void 0x0===y&&(y=q),z['call'](this,A,Z,y)||this;}return j(K,z),K;}(m),d=function(z){function K(){var Z=z['call'](this)||this;Z['poseTracker']=new X(),Z['cameraAngleBase']=0.25*Math['PI'];var y=/iPhone|iPad|iPod/i['test'](navigator['userAgent']);return Z['optimalSize']=y?0x200:0x400,Z;}return j(K,z),K['prototype']['init']=function(Z,y,P){return E(this,void 0x0,void 0x0,function(){return b(this,function(B){switch(B['label']){case 0x0:return[0x4,this['poseTracker']['init'](Z['token'],Z['root'],Z['cache'])];case 0x1:return B['sent'](),[0x4,this['poseTracker']['prepare']()];case 0x2:return B['sent'](),[0x2,z['prototype']['init']['call'](this,Z,y,P)];}});});},K['prototype']['reset']=function(){return this['poseTracker']['reset'](),z['prototype']['reset']['call'](this);},K['prototype']['dispose']=function(){this['poseTracker']['dispose']();},K['prototype']['process']=function(Z,y){return E(this,void 0x0,void 0x0,function(){var P;return b(this,function(B){switch(B['label']){case 0x0:return[0x4,this['poseTracker']['process'](Z,y)];case 0x1:return P=B['sent'](),[0x2,{'poses':P['map'](function(w){return{'points':W['reduce'](function(S,U,T){return S[U]=w['keypoints'][T],S;},{}),'score':w['score'],'debug':w['debug']};})}];}});});},K['prototype']['setupVideo']=function(Z,y){z['prototype']['setupVideo']['call'](this,Z,y),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['poseTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['poseTracker']['reset']();},K;}(O),G=function(z){function K(Z,y){return void 0x0===y&&(y=q),z['call'](this,d,Z,y)||this;}return j(K,z),K;}(m),W=['nose','eyeInnerL','eyeL','eyeOutterL','eyeInnerR','eyeR','eyeOutterR','earL','earR','mouthL','mouthR','shoulderL','shoulderR','elbowL','elbowR','wristL','wristR','pinkyL','pinkyR','indexL','indexR','thumbL','thumbR','hipL','hipR','kneeL','kneeR','ankleL','ankleR','heelL','heelR','footIndexL','footIndexR'];export{R as FaceEngine,A as FaceProcessor,G as PoseEngine,d as PoseProcessor};
